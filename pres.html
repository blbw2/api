<!DOCTYPE html>
<html lang="fr"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-contrib/reveal-auto-agenda-0.0.1/reveal-auto-agenda.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <title>api – Se lancer dans l’acquisition de données par une API</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-1f16b5127ebf71b7a32bc203cc072e67.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Se lancer dans l’acquisition de données par une API</h1>
  <p class="subtitle">Morning Meeting</p>

<div class="quarto-title-authors">
</div>

  <p class="date">lundi 3 février 2025</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Plan de la présentation</h2>
<ul>
<li>Introduction</li>
<li>Requêtes à l’API d’Eurostat</li>
<li>Construire une requête avec <code>rsdmx</code> : l’API OCDE</li>
<li>Autres remarques</li>
</ul>
</nav>
</section>
<section>
<section class="title-slide slide level1 agenda-slide center">
<h1>Introduction</h1>
<div class="agenda-heading">

</div>
<div class="agenda">
<div class="agenda-active">
<p>Introduction</p>
</div>
<div class="agenda-inactive agenda-post-active">
<p>Requêtes à l’API d’Eurostat</p>
</div>
<div class="agenda-inactive agenda-post-active">
<p>Construire une requête avec <code>rsdmx</code> : l’API OCDE</p>
</div>
<div class="agenda-inactive agenda-post-active">
<p>Autres remarques</p>
</div>
</div>
</section>
<section id="les-api" class="slide level2">
<h2>Les API ?</h2>
<ul>
<li><p><strong>Par API, on va désigner les modalités mises en place par une institution pour avoir accès à ses données, en formulant des <em>requêtes</em>, qui permettent de récupérer lesdites données directement sur R</strong>.</p></li>
<li><p>Une API permet une communication directe aux serveurs de l’institution, et via ceux-ci à ses propres dépôts de données, au moyen de code exécutable.</p></li>
</ul>
</section>
<section id="les-portails" class="slide level2">
<h2>Les « portails »</h2>
<ul>
<li>Une autre manière de récupérer des données : se rendre sur le site d’un institut statistique, puis naviguer jusqu’à trouver une série, et enfin cliquer sur un bouton de téléchargement (le plus souvent au format exc*l).</li>
</ul>

<img data-src="portail_dl.png" class="r-stretch quarto-figure-center"><p class="caption">Exemple d’un téléchargement manuel : portail Eurostat</p></section>
<section id="api-et-portails" class="slide level2">
<h2>API et portails</h2>
<ul>
<li><p>L’opposition API/portail est assez artificielle :</p>
<ul>
<li>Lorsqu’on accède au portail, en réalité on accède aussi à l’API, juste par une manière plus « clique-bouton ».</li>
<li>Surtout, comme on va le voir dans les cas pratiques, <strong>il est généralement extrêmement utile d’avoir le portail ouvert sur un onglet lorsqu’on prépare ses requêtes API</strong>.</li>
</ul></li>
</ul>
</section>
<section id="est-ce-que-cest-dur" class="slide level2">
<h2>Est-ce que c’est dur ?</h2>
<p>(Mon ressenti personnel) : pas vraiment, au sens où il n’y a pas besoin d’être compétent en informatique etc. Par contre ça peut être très frustrant, voire paraître incompréhensible au début.</p>
<ul>
<li>Notamment parce qu’au début, R va surtout renvoyer des messages peu encourageants du type <span style="color:red;">ERROR 404 : REQUEST NOT FOUND</span>.</li>
<li>Tandis que la documentation API fournie par les instituts est souvent trop élémentaire/technique/détaillée, et pas assez « voici un exemple d’une requête qui marche, et qui peut facilement être réadaptée ».</li>
</ul>
<p>Les instituts statistiques ont des API et des portails (et des liens entre les deux) plus ou moins harmonisés.</p>
<ul>
<li>En général il faut quelques heures au moins pour se familiariser avec le fonctionnement d’une API, sans parler des particularités en termes d’élaboration des comptes nationaux ou autres variables d’intérêts propres au pays/à l’institution…</li>
</ul>
<p>Par contre, <em>une fois que le coût d’entrée pour se familiariser avec l’API etc a été payé, et que l’infrastructure de codes a été mise en place</em> :</p>
<ul>
<li>Ca marche bien, c’est fiable et rapide ;</li>
<li>On peut assez facilement aller chercher des jeux de données qu’on ne connaissait pas avant.</li>
</ul>
</section></section>
<section>
<section class="title-slide slide level1 agenda-slide center">
<h1>Requêtes à l’API d’Eurostat</h1>
<div class="agenda-heading">

</div>
<div class="agenda">
<div class="agenda-inactive agenda-pre-active">
<p>Introduction</p>
</div>
<div class="agenda-active">
<p>Requêtes à l’API d’Eurostat</p>
</div>
<div class="agenda-inactive agenda-post-active">
<p>Construire une requête avec <code>rsdmx</code> : l’API OCDE</p>
</div>
<div class="agenda-inactive agenda-post-active">
<p>Autres remarques</p>
</div>
</div>
</section>
<section id="quelques-mots-sur-eurostat" class="slide level2">
<h2>Quelques mots sur Eurostat</h2>
<ul>
<li><strong>Eurostat est une bonne source pour tout ce qui a trait aux comptes nationaux et autres données harmonisées (enquêtes force de travail…).</strong>
<ul>
<li>Mis à jour rapidement (au pire quelques jours de délais après la publication des comptes par l’institut national) ;</li>
<li>Le package <code>eurostat</code> est facile d’utilisation, et construire ses propres requêtes est simple.</li>
<li>Le portail est bien fait et assez réactif, le seul défaut est peut-être son arborescence pas forcément intuitive (au début).</li>
</ul></li>
<li><strong>Par contre, Eurostat se limite à ce qui est harmonisé et commun aux Etats-membres de l’UE</strong>.
<ul>
<li>Exit donc, par ex., les ventilations fines de l’INSEE…</li>
<li>Et pas question de retrouver toutes les données spécifiques aux choix de statistique publique des pays : les séries relatives au marché du travail notamment.</li>
</ul></li>
</ul>
</section>
<section id="en-utilisant-le-package-eurostat" class="slide level2">
<h2>En utilisant le package <code>eurostat</code></h2>
<p>C.f. l’exemple de code.</p>
<p>Si la recherche de jeux de données sur R, via les fonctions d’<code>eurostat</code>, ne vous convient pas, on peut très bien commencer sur le portail :</p>
<ul>
<li>Aller sur le site eurostat, faire dérouler l’onglet « Données » puis cliquer sur « Base de données ».</li>
<li>Naviguer au sein de l’arborescence jusqu’à trouver le jeu de données voulu.</li>
<li>(S’assurer que les données correspondent bien à ce que l’on cherchait !)</li>
<li>Faire afficher les codes (c.f. capture d’écran), puis filtrer le jeu de données à sa convenance ; les identifiants des dimensions possibles (pays, unité de mesure, secteur…) et les codes des différentes modalités sont ensuite utilisées par la fonction <code>get_eurostat()</code>.</li>
</ul>
</section>
<section id="une-requête-avec-eurostat" class="slide level2">
<h2>Une requête avec <code>eurostat</code></h2>
<p>On récupère les identifiants des dimensions et les codes des modalités… <img data-src="portail_ids.png"></p>
</section>
<section id="une-requête-avec-eurostat-1" class="slide level2">
<h2>Une requête avec <code>eurostat</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>gdpq_filter <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">geo =</span> <span class="st">"DE"</span>, </span>
<span id="cb1-2"><a></a>                    <span class="at">s_adj =</span> <span class="st">"SCA"</span>,</span>
<span id="cb1-3"><a></a>                    <span class="at">na_item =</span> <span class="st">"B1GQ"</span>,</span>
<span id="cb1-4"><a></a>                    <span class="at">unit =</span> <span class="fu">c</span>(<span class="st">"CLV_MEUR20"</span>, <span class="st">"CP_MEUR"</span>),</span>
<span id="cb1-5"><a></a>                    <span class="at">sinceTimePeriod =</span> <span class="st">"2019-Q4"</span>,</span>
<span id="cb1-6"><a></a>                    <span class="at">untilTimePeriod =</span> <span class="st">"2024-Q4"</span>)</span>
<span id="cb1-7"><a></a></span>
<span id="cb1-8"><a></a>estat_gdpq_DE <span class="ot">&lt;-</span> <span class="fu">get_eurostat</span>(<span class="at">id =</span> <span class="st">"namq_10_gdp"</span>,</span>
<span id="cb1-9"><a></a>                              <span class="at">filter =</span> gdpq_filter)</span>
<span id="cb1-10"><a></a></span>
<span id="cb1-11"><a></a>estat_gdpq_DE <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  freq  unit    s_adj na_item geo   time       values
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;date&gt;      &lt;dbl&gt;
1 Q     CP_MEUR SCA   B1GQ    DE    2019-10-01 894560
2 Q     CP_MEUR SCA   B1GQ    DE    2020-01-01 881485
3 Q     CP_MEUR SCA   B1GQ    DE    2020-04-01 809073
4 Q     CP_MEUR SCA   B1GQ    DE    2020-07-01 867876
5 Q     CP_MEUR SCA   B1GQ    DE    2020-10-01 884210
6 Q     CP_MEUR SCA   B1GQ    DE    2021-01-01 886534</code></pre>
</div>
</div>
</section></section>
<section>
<section class="title-slide slide level1 agenda-slide center">
<h1>Construire une requête avec <code>rsdmx</code> : l’API OCDE</h1>
<div class="agenda-heading">

</div>
<div class="agenda">
<div class="agenda-inactive agenda-pre-active">
<p>Introduction</p>
</div>
<div class="agenda-inactive agenda-pre-active">
<p>Requêtes à l’API d’Eurostat</p>
</div>
<div class="agenda-active">
<p>Construire une requête avec <code>rsdmx</code> : l’API OCDE</p>
</div>
<div class="agenda-inactive agenda-post-active">
<p>Autres remarques</p>
</div>
</div>
</section>
<section id="le-standard-sdmx" class="slide level2">
<h2>Le standard SDMX</h2>
<ul>
<li><p><strong>SDMX est un standard de dissémination de données, porté notamment par certaines institutions telles qu’Eurostat, le FMI, l’OCDE, la BRI…</strong></p></li>
<li><p><strong>SDMX implique donc une certaine harmonisation dans l’organisation des API, et surtout dans la structure des requêtes qu’on peut leur envoyer</strong>.</p>
<ul>
<li>Cette harmonisation est loin d’être complète ! Elle permet néanmoins que les habitudes acquies pour construire une requête vers une API SDMX se transfèrent assez bien aux autres.</li>
</ul></li>
</ul>
</section>
<section id="la-structure-dune-requête-sdmx" class="slide level2">
<h2>La structure d’une requête SDMX</h2>
<ul>
<li><p>Les institutions ayant une API ont sur leurs sites une/des page(s) expliquant le fonctionnement de celle-ci. On trouvera notamment des éléments sur la structure des requêtes (ne pas hésiter à googler !).</p></li>
<li><p><strong>On va travailler ici à partir de l’API de l’OCDE</strong>, pour laquelle la structure d’une requête est la suivante :</p></li>
</ul>

<img data-src="oecd_dataquery.png" class="r-stretch"></section>
<section id="la-structure-dune-requête-sdmx-1" class="slide level2">
<h2>La structure d’une requête SDMX</h2>
<p>On a donc une série d’éléments à définir pour construire une requête :</p>
<ul>
<li>l’URL de l’hôte (ou « endpoint ») : sert de base à toutes les requêtes vers une API donnée, et assez facile à trouver sur le site de l’institution.</li>
<li>l’agence productrice des données ;</li>
<li>l’identifiant du <em>dataset</em> ;</li>
<li>la version du dataset (optionnelle)</li>
<li>la <strong>clé/<em>key</em></strong> (ici « Data selection »).</li>
</ul>
<p>Il y a une certaine variabilité dans les structures de requêtes, selon les institutions.</p>
<ul>
<li>Les deux constantes sont la présence de l’URL de l’hôte, la nécessité d’inclure un identifiant de dataset (ou dataflow), et la clé.</li>
</ul>
</section>
<section id="utiliser-un-portail-pour-créer-sa-requête-sdmx" class="slide level2">
<h2>Utiliser un portail pour créer sa requête SDMX</h2>
<p>Identifier le jeu de données (chaque institution regroupe ses séries à sa propre façon…), récupérer son identifiant, puis comprendre la structure de sa clé et cibler les modalités des dimensions est ce qui prend le plus de temps.</p>
<p>Dans le cas de l’OCDE, et dans une certaine mesure pour les autres institutions également, on peut facilement construire une requête à partir du portail :</p>

<img data-src="oecd_querybuild.png" class="r-stretch"><p>Ici on peut même carrément copier la requête et la copier, puis lancer la requête via la fonction <code>read_SDMX()</code>. Si on souhaite ajuster la requête, il suffit de modifier les paramètres de filtrage (à gauche sur la capture d’écran).</p>
</section>
<section id="construire-sa-propre-requête-en-restant-autant-que-possible-sur-r." class="slide level2">
<h2>Construire sa propre requête en restant (autant que possible) sur R.</h2>
<ul>
<li>Néanmoins, toutes les institutions n’ont pas un portail aussi bien conçu que l’OCDE. Par ailleurs, à terme, on gagne quand même à se familiariser avec la structure d’une API en termes de temps pour construire une nouvelle requête et de compréhension de l’outil qu’on utilise pour récupérer ses données.</li>
</ul>
<p>La séquence habituelle pour construire sa requête est la suivante :</p>
<ul>
<li>Trouver, généralement sur le site de l’institution, le <em>endpoint</em> de l’API, sa syntaxe, et les nuances dans les requêtes pour données vs métadonnées de structure.</li>
<li>Récupérer la liste de tous les jeux de données : identifier celui qui contient les séries recherchées.</li>
<li>Récupérer la DSD de ce jeu de données.</li>
<li>Récupérer les codes pour les modalités des dimensions de ce jeu de données.</li>
</ul>
<p><strong>Ne pas hésiter à s’aider du portail lorsque cela est possible</strong> !</p>
<ul>
<li>Par exemple, pour s’assurer d’être sur le bon jeu de données : l’arborescence d’un portail peut être intuitive et donc faciliter la recherche ; et permet en plus de jeter un coup d’oeil aux valeurs pour vérifier qu’on est au bon endroit.</li>
<li>Ce n’est pas garanti, mais les listes de codes que renvoient les API sont souvent trop larges (par exemple, pour la dimension « Unité » on trouvera 700+ codes différents mélangeants masse, devise, pourcentage…). Sur les portails, seuls les codes pertinents pour une série seront listés.</li>
</ul>
</section></section>
<section>
<section class="title-slide slide level1 agenda-slide center">
<h1>Autres remarques</h1>
<div class="agenda-heading">

</div>
<div class="agenda">
<div class="agenda-inactive agenda-pre-active">
<p>Introduction</p>
</div>
<div class="agenda-inactive agenda-pre-active">
<p>Requêtes à l’API d’Eurostat</p>
</div>
<div class="agenda-inactive agenda-pre-active">
<p>Construire une requête avec <code>rsdmx</code> : l’API OCDE</p>
</div>
<div class="agenda-active">
<p>Autres remarques</p>
</div>
</div>
</section>
<section id="dbnomics" class="slide level2">
<h2>DBnomics</h2>
<p>DBnomics centralise les données disséminées par un certain nombre d’institutions, du type FMI OCDE ainsi qu’une grande partie des instituts statistiques européens.</p>
<ul>
<li><p>Grand avantage : DBnomics a son propre package, et une manière homogène de formuler des requêtes vers son API. Le site est facile à naviguer et récupérer les identifiants de série, les codes pour filtrer une série etc ne pose pas de problème.</p>
<ul>
<li>En revanche, pour une institution donnée, DBnomics va reproduire son organisation, sa hierarchisation des données, ses noms de variables etc. Donc il faut quand même passer du temps à se familiariser avec ces éléments.</li>
</ul></li>
<li><p>Principal défaut de DBnomics : pour certaines API, il peut y avoir des délais dans la mise à jour des données. Parfois, il semble même que DBnomics interrompe son suivi d’une API (l’OCDE pendant quelques mois, par ex.).</p></li>
</ul>
</section>
<section id="quelques-observations-sur-les-api" class="slide level2">
<h2>Quelques observations sur les API :</h2>
<ul>
<li><p><strong>BCE, BRI</strong> : j’ai peu d’expérience avec, mais elles marchent bien. Leurs portails soient moins bien conçus qu’ESTAT ou l’OCDE, donc construire ses requêtes peut être un peu plus fastidieux.</p></li>
<li><p><strong>INE</strong> : on peut construire ses requêtes directement à partir du portail. Il y a un package R (<code>INEapir</code>) maintenu par l’INE, avec une <em>cheat sheet</em> résumant les fonctionnalités.</p></li>
<li><p><strong>Destatis</strong> : le package <code>restatis</code> est utile… Mais le portail n’est pas très bien conçu, et certaines données visibles sur le portail ne sont pas structurées de la même manière sur l’API.</p></li>
<li><p><strong>ONS</strong> : leur API est en cours de développement, seule une petite partie de leurs données sont accessibles. Privilégier l’OCDE (ou DBnomics, mais il semble qu’il y ait un délai de plusieurs jours voire une semaine.)</p></li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="_extensions/ofce/pres/ofce_m.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Se lancer dans l’acquisition de données par une API <i class="fa-solid fa-ellipsis" aria-label="ellipsis"></i> </p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copié");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copié");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/blbw2\.github\.io\/api\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>